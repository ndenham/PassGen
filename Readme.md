PassGen Bookmarklet
===================

PassGen is a Javascript bookmarklet which will allow the user to conveniently generate
random passwords. The user has the ability to configure password length and which
character types are to be included, i.e. a-z, A-Z, 0-9, !#@$? etc. The symbol set
can be modified on the fly to allow for idiotic websites with poor password policies.

This bookmarket will attempt to use the CSPRNG built-into most modern
browsers but will ultimately fall back to Math.Random() if none are available. A very
poorly conducted statistical analysis of 10,000 output characters proved the characters
to be evenly distributed, when using the CSPRNG. 

The code attached above could be easily modifiedin a variety of ways, but it then needs
to be crunchfied by one of a variety of sources. Or you could just drag [this link](javascript:(function(){generate=function(){var atoz="abcdefghijklmnopqrstuvwxyz";var atozcap="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var nums="0123456789";var symbols=document.getElementById("symbols").value;var charset='';if(document.getElementById("capslets").checked)charset+=atozcap;if(document.getElementById("lowlets").checked)charset+=atoz;if(document.getElementById("numbers").checked)charset+=nums;if(document.getElementById("symbolcheckbox").checked)charset+=symbols;var password='';var numchars=document.getElementById("maxchars").value;if(window.crypto&&window.crypto.getRandomValues){var randomWords=new Uint32Array(numchars);window.crypto.getRandomValues(randomWords);for(i in randomWords){randomWords[i]=randomWords[i]/(4294967295/charset.length);password+=charset[randomWords[i]];}}else if(window.msCrypto&&window.msCrypto.getRandomValues){"use strict";var randomWords=new Uint32Array(parseInt(numchars));msCrypto.getRandomValues(randomWords);for(i in randomWords){randomWords[i]=randomWords[i]/(4294967295/charset.length);password+=charset[randomWords[i]];}}else{for(var i=0;i<numchars;i++){var rand=Math.floor(Math.random()*(charset.length-1+1));password+=charset[rand];}}document.getElementById("genpassword").value=password;document.getElementById("genpassword").select();};closemodal=function(){document.body.removeChild(document.getElementById("options"));};var div=document.createElement("div");div.style.zIndex="10000";div.style.position="fixed";div.style.top="100px";div.style.left="200px";div.style.backgroundColor="#fff";div.style.border="thin outset black";div.style.width="300px";div.innerHTML="Password: <input type='text' id='genpassword' maxlength='999' size='12' value='To be generated'/><br>Max Chars: <input type='text' id='maxchars' maxlength='3' size='1' value='12'/><br>Allowed: A-Z<input type='checkbox' id='capslets' checked='checked'/> a-z <input type='checkbox'id='lowlets' checked='checked'/> 0-9 <input type='checkbox' id='numbers' checked='checked'/> Symbols<input type='checkbox' id='symbolcheckbox'/><input type='text' id='symbols' size='10' value='~!@#$%^&*()_+`-=[]\{}|;:,./<>?'/><input type='button' value='Generate' onclick='generate()'/><input type='button' value='Close' onclick='closemodal()'/>";div.id="options";document.body.appendChild(div);})();)
onto your bookmark bar. 